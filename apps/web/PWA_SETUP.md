# Progressive Web App (PWA) Setup

This document describes the PWA configuration for Douro Bats Padel.

## ‚úÖ What's Been Configured

### 1. **PWA Plugin** (`next-pwa`)
- Installed and configured in `next.config.ts`
- Automatically generates service worker
- Disabled in development mode for easier debugging
- Enabled in production builds

### 2. **Web App Manifest** (`public/manifest.json`)
- App name: "Douro Bats Padel"
- Short name: "Douro Bats"
- Display mode: standalone (looks like a native app)
- Theme colors configured
- Icon definitions for all required sizes

### 3. **Metadata & Meta Tags** (`src/app/layout.tsx`)
- Apple Web App meta tags
- Theme color configuration
- Viewport settings optimized for mobile
- Manifest link
- Apple touch icons

### 4. **Offline Support**
- Offline fallback page (`public/offline.html`)
- Service worker caching strategies
- Auto-retry when connection restored

### 5. **Icons**
- SVG source icon created (`public/icons/icon.svg`)
- Icon generator tool (`scripts/generate-icons.html`)
- Instructions for generating PNG icons

## üì± Features

### Installability
- ‚úÖ Users can install the app on their home screen
- ‚úÖ Works on iOS, Android, and Desktop
- ‚úÖ Standalone display mode (no browser UI)

### Offline Capability
- ‚úÖ Offline fallback page
- ‚úÖ Service worker caching
- ‚úÖ Auto-reconnect detection

### Performance
- ‚úÖ Pre-caching of critical assets
- ‚úÖ Runtime caching strategies
- ‚úÖ Fast loading times

### Native-like Experience
- ‚úÖ Splash screen on launch
- ‚úÖ App icon on home screen
- ‚úÖ No browser chrome
- ‚úÖ Smooth animations

## üöÄ How to Test PWA

### Development
```bash
pnpm dev
```
Note: Service worker is disabled in development mode.

### Production Build
```bash
pnpm build
pnpm start
```

### Testing Installation

#### On Desktop (Chrome/Edge)
1. Open the app in Chrome/Edge
2. Look for the install icon in the address bar
3. Click "Install" to add to desktop

#### On Android
1. Open the app in Chrome
2. Tap the menu (‚ãÆ)
3. Select "Add to Home screen"
4. Confirm installation

#### On iOS
1. Open the app in Safari
2. Tap the Share button
3. Select "Add to Home Screen"
4. Confirm installation

## üìã Checklist

### Required for PWA
- [x] Web App Manifest
- [x] Service Worker (auto-generated by next-pwa)
- [x] HTTPS (required in production)
- [ ] App Icons (PNG files need to be generated)
- [x] Offline fallback page
- [x] Meta tags for mobile

### Recommended
- [x] Theme color
- [x] Apple touch icons
- [x] Favicon
- [ ] Screenshots for app stores
- [ ] App description
- [ ] Categories

## üé® Generating Icons

### Option 1: Use the HTML Generator
1. Open `apps/web/scripts/generate-icons.html` in a browser
2. Click "Generate All Icons"
3. Download each icon
4. Save to `apps/web/public/icons/`

### Option 2: Use ImageMagick
```bash
cd apps/web/public/icons

for size in 72 96 128 144 152 192 384 512; do
  convert icon.svg -resize ${size}x${size} icon-${size}x${size}.png
done
```

### Option 3: Use Online Tools
- [PWA Builder](https://www.pwabuilder.com/imageGenerator)
- [RealFaviconGenerator](https://realfavicongenerator.net/)

## üîß Configuration Files

### `next.config.ts`
```typescript
import withPWA from "next-pwa"

export default withPWA({
  dest: "public",
  register: true,
  skipWaiting: true,
  disable: process.env.NODE_ENV === "development",
})(nextConfig)
```

### `public/manifest.json`
Contains app metadata, icons, and display settings.

### Service Worker
Auto-generated by `next-pwa` during build.
Located at `public/sw.js` and `public/workbox-*.js` after build.

## üìä PWA Audit

To check PWA compliance:

1. Build the app: `pnpm build && pnpm start`
2. Open Chrome DevTools
3. Go to "Lighthouse" tab
4. Run "Progressive Web App" audit

## üåê Deployment Considerations

### HTTPS Required
- PWA requires HTTPS in production
- Service workers only work over HTTPS
- localhost is exempt for development

### Caching Strategy
The service worker uses the following strategies:
- **Static assets**: Cache first, network fallback
- **API calls**: Network first, cache fallback
- **Images**: Cache first with expiration

### Updates
- Service worker updates automatically
- Users get new version on next visit
- `skipWaiting: true` ensures immediate activation

## üêõ Troubleshooting

### Service Worker Not Registering
- Check browser console for errors
- Ensure HTTPS in production
- Clear browser cache and reload

### Icons Not Showing
- Generate PNG icons from SVG
- Check file paths in manifest.json
- Verify icon sizes match manifest

### App Not Installable
- Run Lighthouse PWA audit
- Check manifest.json is accessible
- Ensure all required icons exist
- Verify HTTPS in production

## üìö Resources

- [Next PWA Documentation](https://github.com/shadowwalker/next-pwa)
- [Web.dev PWA Guide](https://web.dev/progressive-web-apps/)
- [MDN PWA Guide](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)
- [PWA Builder](https://www.pwabuilder.com/)

